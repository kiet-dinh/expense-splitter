---
phase: 02-core-ui
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - gsd-module-test/src/components/PeopleSection.tsx
  - gsd-module-test/src/components/PeopleSection.test.tsx
  - gsd-module-test/src/components/ItemSection.tsx
  - gsd-module-test/src/components/ItemSection.test.tsx
  - gsd-module-test/src/App.tsx
autonomous: true
requirements:
  - PEOPLE-01
  - PEOPLE-02
  - PEOPLE-03
  - PEOPLE-04
  - ITEM-01
  - ITEM-02
  - ITEM-03
  - ITEM-04

must_haves:
  truths:
    - "User can type a name and add a person to the bill"
    - "User can remove a person from the list"
    - "User sees a warning when entering a duplicate name (case-insensitive)"
    - "User can add an item with a name and dollar price"
    - "User can click an item to edit its name or price inline"
    - "User can delete an item from the list"
    - "User sees a running subtotal that updates as items change"
  artifacts:
    - path: "gsd-module-test/src/components/PeopleSection.tsx"
      provides: "People management UI with add, remove, duplicate warning"
      min_lines: 40
    - path: "gsd-module-test/src/components/PeopleSection.test.tsx"
      provides: "Component tests for people management"
      min_lines: 30
    - path: "gsd-module-test/src/components/ItemSection.tsx"
      provides: "Item entry UI with add, inline edit, delete, running subtotal"
      min_lines: 50
    - path: "gsd-module-test/src/components/ItemSection.test.tsx"
      provides: "Component tests for item entry"
      min_lines: 30
  key_links:
    - from: "gsd-module-test/src/components/PeopleSection.tsx"
      to: "gsd-module-test/src/store/billStore.ts"
      via: "useBillStore hook for people state and actions"
      pattern: "useBillStore"
    - from: "gsd-module-test/src/components/ItemSection.tsx"
      to: "gsd-module-test/src/store/billStore.ts"
      via: "useBillStore hook for items state and actions"
      pattern: "useBillStore"
    - from: "gsd-module-test/src/components/ItemSection.tsx"
      to: "gsd-module-test/src/engine/math.ts"
      via: "dollarsToCents for price input, centsToDollars for display"
      pattern: "dollarsToCents|centsToDollars"
    - from: "gsd-module-test/src/App.tsx"
      to: "gsd-module-test/src/components/PeopleSection.tsx"
      via: "imports and renders PeopleSection"
      pattern: "import.*PeopleSection"
    - from: "gsd-module-test/src/App.tsx"
      to: "gsd-module-test/src/components/ItemSection.tsx"
      via: "imports and renders ItemSection"
      pattern: "import.*ItemSection"
---

<objective>
Build the People and Item management UI sections — the first two visible panels of the app. Users can add/remove people, see duplicate warnings, add/edit/delete items, and see a running subtotal.

Purpose: These are the data-entry panels that feed all downstream features (assignments, tip/tax, results). Without people and items in the store, the rest of the app has nothing to work with.

Output: PeopleSection.tsx, ItemSection.tsx, their test files, and App.tsx updated to render both sections.
</objective>

<execution_context>
@C:/Users/Kiet Dinh/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Kiet Dinh/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-ui/02-01-SUMMARY.md
@.planning/phases/02-core-ui/02-RESEARCH.md (Pattern 4: Price Input, Pattern 5: useId, Pattern 6: useShallow, Pattern 7: aria-live)
@gsd-module-test/src/store/billStore.ts
@gsd-module-test/src/engine/math.ts
@gsd-module-test/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PeopleSection component with add, remove, and duplicate warning</name>
  <files>
    gsd-module-test/src/components/PeopleSection.tsx
    gsd-module-test/src/components/PeopleSection.test.tsx
  </files>
  <action>
    **Create `src/components/PeopleSection.tsx`:**

    Structure:
    - A section with heading "People"
    - A controlled text input for name entry + "Add" button
    - Form submission via Enter key or button click
    - After adding, clear the input field
    - Below the input: a list of added people, each with a name label and a "Remove" button
    - Duplicate warning: as the user types, if the trimmed input (case-insensitive) matches an existing person name, show a warning text like "Name already added" below the input. The warning is informational — it does NOT prevent adding (per PEOPLE-03 research note: "does NOT block adding").
    - PEOPLE-04 (quick-add from previous splits): Explicitly omit — depends on Phase 4 persistence. Do NOT add a stub button or placeholder. Document in a code comment: `// PEOPLE-04: quick-add from previous splits — deferred to Phase 4 (requires localStorage)`

    Implementation details:
    - Use `useShallow` from `zustand/shallow` for selecting multiple store values: `{ people, addPerson, removePerson }`
    - Use `useState` for the name input (controlled component)
    - Duplicate check: `people.some(p => p.name.toLowerCase() === input.trim().toLowerCase())`
    - Use `useId()` from React for accessible label/input linkage
    - Use person.id as React list key (NOT array index)
    - Tailwind classes for styling: section padding, input with border and focus ring, button styles, list with spacing, remove button with red text

    **Create `src/components/PeopleSection.test.tsx`:**

    Top of file: `// @vitest-environment jsdom`

    Tests:
    - Renders an input and add button
    - Adding a person: type name, click add, name appears in list
    - Adding clears the input field
    - Duplicate warning appears when typing an existing name (case-insensitive)
    - Duplicate warning disappears when input changes to non-duplicate
    - Remove button removes the person from the list
    - Empty name is not added (trim check)

    Use `@testing-library/react` for render/screen, `@testing-library/user-event` for interactions. Reset store in `beforeEach` using `useBillStore.setState(...)`.
  </action>
  <verify>
    - `cd gsd-module-test && npx vitest run src/components/PeopleSection.test.tsx` — all tests pass
    - `npx tsc --noEmit` — no type errors
  </verify>
  <done>PeopleSection renders with name input, add/remove functionality, and case-insensitive duplicate warning. All component tests pass in jsdom environment.</done>
</task>

<task type="auto">
  <name>Task 2: Create ItemSection component with add, inline edit, delete, and running subtotal</name>
  <files>
    gsd-module-test/src/components/ItemSection.tsx
    gsd-module-test/src/components/ItemSection.test.tsx
    gsd-module-test/src/App.tsx
  </files>
  <action>
    **Create `src/components/ItemSection.tsx`:**

    Structure:
    - Section heading "Items"
    - Add form: name input + price input (dollar format, e.g. "12.50") + "Add Item" button
    - Item list: each row shows name, price display, Edit and Delete buttons
    - Inline edit: clicking Edit (or double-clicking the row) enters edit mode for that item — shows name input and price input pre-populated with current values. Blur or Enter confirms the edit. Escape cancels.
    - Running subtotal: displayed below the list in an `aria-live="polite"` region. Sum all item priceCents, display via `centsToDollars`. MUST be present in DOM at mount time (not conditionally rendered).

    Implementation details:
    - Add form: local state for `nameInput` (string) and `priceInput` (string). On submit: convert price via `dollarsToCents(priceInput)`, call `addItem(nameInput.trim(), cents)`, clear both inputs. Do NOT add if name is empty or price is 0.
    - Inline edit: local state `editingId: string | null` and `editName: string`, `editPrice: string`. When editingId matches item.id, show inputs instead of text. On blur/enter: `updateItem(id, { name: editName.trim(), priceCents: dollarsToCents(editPrice) })`, set editingId to null.
    - Price input pattern (from research Pattern 4): keep string state while typing, convert to cents only on blur/submit. This avoids cursor-jump bugs.
    - Use `useShallow` for store selection: `{ items, addItem, updateItem, removeItem }`
    - Import `dollarsToCents`, `centsToDollars` from `'../engine/math'`
    - Use `useId()` for accessible labels
    - Use item.id as React list key
    - Tailwind styling: table-like layout or card rows, price right-aligned, subtotal bold, edit mode with different background

    **Create `src/components/ItemSection.test.tsx`:**

    Top of file: `// @vitest-environment jsdom`

    Tests:
    - Renders name input, price input, and add button
    - Adding an item: type name and price, click add, item appears in list with formatted price
    - Adding clears both input fields
    - Subtotal updates when item is added (aria-live region contains updated value)
    - Delete button removes item from list and updates subtotal
    - Inline edit: click edit, change name, blur → name updates
    - Inline edit: change price, blur → price updates in cents
    - Cannot add item with empty name

    **Update `src/App.tsx`:**

    Replace the placeholder content with a proper app layout:
    ```tsx
    import { PeopleSection } from './components/PeopleSection'
    import { ItemSection } from './components/ItemSection'

    function App() {
      return (
        <div className="min-h-screen bg-gray-50">
          <div className="mx-auto max-w-2xl px-4 py-8">
            <h1 className="text-2xl font-bold text-gray-900 mb-6">Expense Splitter</h1>
            <div className="space-y-6">
              <PeopleSection />
              <ItemSection />
              {/* AssignSection, TipTaxSection, ResultsSection added in 02-03 */}
            </div>
          </div>
        </div>
      )
    }

    export default App
    ```
    - Mobile-first: max-w-2xl centered, padding, vertical stack
    - Comment placeholder for sections coming in 02-03
  </action>
  <verify>
    - `cd gsd-module-test && npx vitest run src/components/ItemSection.test.tsx` — all tests pass
    - `cd gsd-module-test && npx vitest run` — ALL tests pass (engine + store + computeResults + PeopleSection + ItemSection)
    - `cd gsd-module-test && npx tsc --noEmit` — no type errors
    - `cd gsd-module-test && npm run build` — builds without errors
    - `cd gsd-module-test && npm run dev` — app renders PeopleSection and ItemSection
  </verify>
  <done>ItemSection renders with add form, inline edit, delete, and live-updating subtotal. App.tsx composes PeopleSection and ItemSection in a mobile-first layout. All tests pass, app builds and runs.</done>
</task>

</tasks>

<verification>
1. `cd gsd-module-test && npx vitest run` — all tests pass
2. `cd gsd-module-test && npx tsc --noEmit` — no type errors
3. `cd gsd-module-test && npm run build` — builds
4. `cd gsd-module-test && npm run dev` — renders People and Items sections
5. Manually verify: can add/remove people, see duplicate warning, add/edit/delete items, see running subtotal
</verification>

<success_criteria>
- PeopleSection: add person, remove person, duplicate name warning (case-insensitive), PEOPLE-04 deferred
- ItemSection: add item with name+price, inline edit, delete, running subtotal with aria-live
- App.tsx composes both sections in a responsive layout
- All component tests pass in jsdom environment
- All prior tests (engine, store, computeResults) still pass
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-ui/02-02-SUMMARY.md`
</output>
